'Agrupa filas de una planilla de cotización en función de sus códigos. En prin-
'cipio hace falta separar cada código en columnas e identificar:
'FirstRow: Primera fila a agrupar
'LastRow: Última fila a agrupar
'LastColumn: Columna donde se encuentra el código de mayor nivel de anidación
'parámetro se usa para indentar las descripciones de cada ítem según su nivel de
'anidación
Sub AgruparItems()

    'Configurar visualización del agrupamiento
    With ActiveSheet.Outline
        .AutomaticStyles = False
        .SummaryRow = xlAbove
        .SummaryColumn = xlRight
    End With

    'Borrar Esquema previo
    ActiveSheet.Cells.ClearOutline

    'Variables a usar (algunas)
    Dim cl As Range, MySel As Range, rng As Range, LastColumn As String, FirstRow As Integer, LastRow As Integer
       
    'Rango segun el cual agrupar
    Set Rango = Application.InputBox(prompt:="Rango: ", Type:=8)
    
    'Primera fila
    PrimeraFila = Rango.Row

    'Ultima fila
    UltimaFila = Rango.Row + Rango.Rows.Count
    
    'Parámetros de entrada
    FirstRow = PrimeraFila + 1
    LastRow = UltimaFila
    LastColumn = Chr(Rango.Column + 64)
    
    'Transformación de letras en su código ASCII correspondiente
    LastColumnAscii = Asc(LastColumn)
    FirstColumnAscii = Asc("A") + 1
    
    'Rango de filas con las descripciones de cada ítem
    Range(Chr(LastColumnAscii) & "1:" & Chr(LastColumnAscii) & LastRow).Select
    
    'Iteración por todas las filas
    For Each cl In Selection
    
        'Nivel de agrupamiento
        nd = cl.IndentLevel
        
        'Para cada nivel de indentación
        For k = 0 To (nd / 2 - 1) Step 1
            
            'Bajar un nivel de agrupamiento
            cl.Rows.Group
            
        Next
        
    Next
    
End Sub